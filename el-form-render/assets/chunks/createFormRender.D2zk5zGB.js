import{a8 as k,aw as M,p as X,aD as ee,aa as I,ab as te,L as Y,G as P,ac as U,aI as T,ae as ne,b1 as le,H as ae,d as W,af as ie,K as x,a2 as re,r as se,V as ue}from"./framework.C9-9fwSE.js";import{r as oe,o as ce,t as de}from"./theme.0mm1nXGl.js";const D=new WeakMap,Se=e=>{if(!e)return;if(D.has(e))return D.get(e).value;const a=X([]);D.set(e,a);const n=y(e);return ee(n)?n.then(o=>a.value=o.map(q)):a.value=n.map(q),a.value},je=e=>(e==null?void 0:e.label)??(e==null?void 0:e.value),q=e=>I(e)?{label:e[0],value:e[1]}:te(e)?e:{label:e,value:e},fe=(e,a,n={})=>({get(){const r=k(e),s=k(a);if(s==null)return;let t=L(n.untrackedGet?M(r):r,s);return n.get&&(t=n.get(t,r)),n.defaultValue!==void 0&&(t===void 0||t==="")&&C(r,s,t=y(n.defaultValue)),n.displayValue!==void 0&&(t===void 0||t==="")&&(t=y(n.displayValue)),t},set(r){const s=k(e),t=k(a);t!=null&&(n.silentSet?C(M(s),t,n.silentSet(r,s)):n.set?C(s,t,n.set(r,s)):C(s,t,r),n.out&&Object.assign(s,n.out(r,s)),r=L(s,t),n.displayValue!==void 0&&r===y(n.displayValue)&&ve(M(s),t))},get v(){return this.get()},set v(r){this.set(r)},get value(){return this.get()},set value(r){this.set(r)},__v_isRef:!0}),me=/^\d+$/,y=(e,...a)=>typeof e=="function"?e(...a):e;function L(e,a){if(typeof a=="function")return a(e);for(const n of a.split("."))if(!(e=e[n]))break;return e}function C(e,a,n){return a.split(".").reduce((o,r,s,t)=>s==t.length-1?o[r]=n:o[r]??(o[r]=me.test(t[s+1])?[]:{}),e)}function ve(e,a){var o;const n=a.split(".");n.length>1?(o=L(e,n.slice(0,-1).join(".")))==null||delete o[n[n.length-1]]:delete e[n[0]]}const be={is:null,lp:[String,Array],type:String,defaultValue:null,displayValue:null,hide:[Boolean,Function],get:Function,set:Function,out:Function,options:[Array,Object,Function],rules:null,el:Object};for(var K=256,ge=[];K--;)ge[K]=(K+256).toString(16).substring(1);const Q=(e,...a)=>typeof e=="function"?e(...a):e,ye=(e,a)=>Object.fromEntries(Object.entries(e).map(([n,o])=>[n,a(o)]));function he({defaultIs:e,processProps:a=n=>n}){const n=(t,i)=>T(t)?s(t,i):t,o=(t,i)=>{const{is:c,vIf:b,children:u,...f}=t=a(t,i,{provide:m=>i={...i,...m}});return!U(t,"vIf")||Q(b)?P(ae(c||e),f,I(u)?{default:()=>u.map(m=>n(m,i))}:T(u)?ye(u,m=>h=>r(m,i,h)):ne(u)?{default:()=>{const m=u();return I(m)?m.map(h=>n(h,i)):m}}:u!=null&&!le(c)?{default:()=>u}:u):null},r=(t,i,c)=>{if(t.scope)if(t.scope[0]=="{"){i={...i};for(const f of t.scope.slice(1,-1).split(","))i[f.trim()]=c[f.trim()]}else i={...i,[t.scope]:c};const{vIf:b,children:u}=a(t,i,{provide:f=>i={...i,...f}});return!U(t,"vIf")||Q(b)?I(u)?u.map(f=>n(f,i)):T(u)?s(u,i):u:null};function s(t,i={}){if(t.vFor){const{vFor:c}=t,{vFor:b}=a({vFor:c},i,{});if(I(b))return b[0].map((u,f)=>{const m={[b[1]||"item"]:u,[b[1]||"index"]:f};return o(t,{...i,...m})})}else return o(t,i)}return t=>{const i=Y("vars",void 0);return s(t,i)}}const Ve={label:"label",prop:"prop",modelValue:"modelValue",rules:"rules",inputSlot:"default"};function Ie({Form:e,formName:a,formProps:n,FormItem:o,formItemName:r,formItemProps:s,Input:t,fields:i}){const c={...Ve,...i},b=Object.keys(s),u=Symbol(),f=l=>Array.isArray(l)?l:l?[l,ie(l)]:[],m=l=>l[c.label]||f(l.lp)[0],h=l=>l[c.prop]||f(l.lp)[1],Z=(l,_)=>y(l[c.rules],_),N={...s,...be},z=W({props:N,name:r,setup(l,{attrs:_,slots:w}){const F=Y(u),S=oe(()=>(F==null?void 0:F.model)||re({})),R=fe(S,()=>h(l),l);return()=>{const g={...ce(l,b),lp:void 0,[c.label]:m(l),[c.prop]:h(l),[c.rules]:Z(l,S),".__transformer":R};return y(l.hide,S)?void 0:P(o,g,{...w,default:void 0,[c.inputSlot]:()=>{var $,d;const A=x({modelValue:R.get(),"onUpdate:modelValue":R.set,[y(c.modelValue,l)]:R.get(),[`onUpdate:${y(c.modelValue,l)}`]:R.set},{...l.el||{},disabled:y(($=l.el)==null?void 0:$.disabled,S)}),O=se(w,"default");return O.children[0]?O.children[0].props=Object.assign(A,O.children[0].props):(d=O.children)[0]??(d[0]=t({...l,...g,el:A},{attrs:_})),O}})}}}),B={...n,...{model:Object,items:Array}};return{FormRender:W({name:a,props:B,setup(l,{attrs:_,emit:w,slots:F,expose:S}){const R=he({defaultIs:(d,{slots:v})=>P(z,d,{default:v[`$${h(d)}`]??v.default})}),g=X({});S(de(g)),ue(u,l);const A=JSON.stringify(l.model);async function O(d){var v,V,j;_.on_submit&&((v=d.preventDefault)==null||v.call(d),await((j=(V=g.value).validate)==null?void 0:j.call(V)),w("_submit",l.model))}function $(){var d,v,V,j,E,G,H,J;(v=(d=g.value).reset)==null||v.call(d),(j=(V=g.value).resetFields)==null||j.call(V),(G=(E=g.value).restoreValidation)==null||G.call(E),(J=(H=g.value).resetValidation)==null||J.call(H),l.model&&(Object.keys(l.model).forEach(p=>l.model[p]=void 0),Object.assign(l.model,JSON.parse(A||"{}")))}return()=>P(e,x({ref:g},{...l,..._,items:void 0,on_submit:void 0},{onSubmit:O,onReset:$}),{default:()=>{var d,v;return[(d=l.items)==null?void 0:d.map(V=>P(R,x(V,{key:h(V)}),null)),(v=F.default)==null?void 0:v.call(F)]}})}}),formRenderProps:B,FormItemRender:z,formItemRenderProps:N}}export{je as a,Ie as c,L as g,Se as s,y as u};
