import{a8 as k,aw as L,p as Z,aD as te,aa as I,ab as ne,L as K,G as P,ac as W,aI as M,ae as le,b1 as ae,H as ie,d as q,a2 as Q,af as re,K as T,r as se,V as ue}from"./framework.C9-9fwSE.js";import{r as oe,o as ce,t as de}from"./theme.I9pp6g2o.js";const x=new WeakMap,Se=e=>{if(!e)return;if(x.has(e))return x.get(e).value;const i=Z([]);x.set(e,i);const n=y(e);return te(n)?n.then(c=>i.value=c.map(X)):i.value=n.map(X),i.value},je=e=>(e==null?void 0:e.label)??(e==null?void 0:e.value),X=e=>I(e)?{label:e[0],value:e[1]}:ne(e)?e:{label:e,value:e},fe=(e,i,n={})=>({get(){const r=k(e),s=k(i);if(s==null)return;let t=N(n.untrackedGet?L(r):r,s);const a=n.defaultValue??n.defv,u=n.displayValue;return n.get&&(t=n.get(t,r)),a!==void 0&&(t===void 0||t==="")&&C(r,s,t=y(a)),u!==void 0&&(t===void 0||t==="")&&(t=y(u)),t},set(r){const s=k(e),t=k(i);t!=null&&(n.silentSet?C(L(s),t,n.silentSet(r,s)):n.set?C(s,t,n.set(r,s)):C(s,t,r),n.out&&Object.assign(s,n.out(r,s)),r=N(s,t),n.displayValue!==void 0&&r===y(n.displayValue)&&ve(L(s),t))},get v(){return this.get()},set v(r){this.set(r)},get value(){return this.get()},set value(r){this.set(r)},__v_isRef:!0}),me=/^\d+$/,y=(e,...i)=>typeof e=="function"?e(...i):e;function N(e,i){if(typeof i=="function")return i(e);for(const n of i.split("."))if(!(e=e[n]))break;return e}function C(e,i,n){return i.split(".").reduce((c,r,s,t)=>s==t.length-1?c[r]=n:c[r]??(c[r]=me.test(t[s+1])?[]:{}),e)}function ve(e,i){var c;const n=i.split(".");n.length>1?(c=N(e,n.slice(0,-1).join(".")))==null||delete c[n[n.length-1]]:delete e[n[0]]}const be={is:null,lp:[String,Array],type:String,defv:null,defaultValue:null,displayValue:null,hide:[Boolean,Function],get:Function,set:Function,out:Function,options:[Array,Object,Function],rules:null,el:Object};for(var D=256,ge=[];D--;)ge[D]=(D+256).toString(16).substring(1);const Y=(e,...i)=>typeof e=="function"?e(...i):e,ye=(e,i)=>Object.fromEntries(Object.entries(e).map(([n,c])=>[n,i(c)]));function he({defaultIs:e,processProps:i=n=>n}){const n=(t,a)=>M(t)?s(t,a):t,c=(t,a)=>{const{is:u,vIf:g,children:o,...m}=t=i(t,a,{provide:v=>a={...a,...v}});return!W(t,"vIf")||Y(g)?P(ie(u||e),m,I(o)?{default:()=>o.map(v=>n(v,a))}:M(o)?ye(o,v=>h=>r(v,a,h)):le(o)?{default:()=>{const v=o();return I(v)?v.map(h=>n(h,a)):v}}:o!=null&&!ae(u)?{default:()=>o}:o):null},r=(t,a,u)=>{if(t.scope)if(t.scope[0]=="{"){a={...a};for(const m of t.scope.slice(1,-1).split(","))a[m.trim()]=u[m.trim()]}else a={...a,[t.scope]:u};const{vIf:g,children:o}=i(t,a,{provide:m=>a={...a,...m}});return!W(t,"vIf")||Y(g)?I(o)?o.map(m=>n(m,a)):M(o)?s(o,a):o:null};function s(t,a={}){if(t.vFor){const{vFor:u}=t,{vFor:g}=i({vFor:u},a,{});if(I(g))return g[0].map((o,m)=>{const v={[g[1]||"item"]:o,[g[1]||"index"]:m};return c(t,{...a,...v})})}else return c(t,a)}return t=>{const a=K("vars",void 0);return s(t,a)}}const Fe={label:"label",prop:"prop",modelValue:"modelValue",rules:"rules",inputSlot:"default"};function Ie({Form:e,formName:i,formProps:n,FormItem:c,formItemName:r,formItemProps:s,Input:t,fields:a}){const u={...Fe,...a},g=Object.keys(s),o=Symbol(),m=l=>Array.isArray(l)?l:l?[l,re(l)]:[],v=l=>l[u.label]||m(l.lp)[0],h=l=>l[u.prop]||m(l.lp)[1],p=(l,V)=>y(l[u.rules],V),z={...s,...be},B=q({props:z,name:r,setup(l,{attrs:V,slots:w}){const R=K(o),S=K("form-item",void 0),_=oe(()=>(R==null?void 0:R.model)||Q({})),b=fe(_,()=>h(l),l);return()=>{const A={...ce(l,g),lp:void 0,[u.label]:S!=null&&S.noLabel?void 0:v(l),[u.prop]:h(l),[u.rules]:p(l,_),".__transformer":b};return y(l.hide,_)?void 0:P(c,A,{...w,default:void 0,[u.inputSlot]:()=>{var d,f;const $=T({modelValue:b.get(),"onUpdate:modelValue":b.set,[y(u.modelValue,l)]:b.get(),[`onUpdate:${y(u.modelValue,l)}`]:b.set},{...l.el||{},disabled:y((d=l.el)==null?void 0:d.disabled,_)}),O=se(w,"default");return O.children[0]?O.children[0].props=Object.assign($,O.children[0].props):(f=O.children)[0]??(f[0]=t({...l,...A,el:$},{attrs:V})),O}})}}}),E={...n,...{model:{type:Object,default:()=>Q({})},items:Array}};return{FormRender:q({name:i,props:E,setup(l,{attrs:V,emit:w,slots:R,expose:S}){const _=he({defaultIs:(d,{slots:f})=>P(B,d,{default:f[`$${h(d)}`]??f.default})}),b=Z({});S(de(b)),ue(o,l);const A=JSON.stringify(l.model);async function $(d){var f,F,j;V.on_submit&&((f=d.preventDefault)==null||f.call(d),await((j=(F=b.value).validate)==null?void 0:j.call(F)),w("_submit",l.model))}function O(){var d,f,F,j,G,H,J,U;(f=(d=b.value).reset)==null||f.call(d),(j=(F=b.value).resetFields)==null||j.call(F),(H=(G=b.value).restoreValidation)==null||H.call(G),(U=(J=b.value).resetValidation)==null||U.call(J),l.model&&(Object.keys(l.model).forEach(ee=>l.model[ee]=void 0),Object.assign(l.model,JSON.parse(A||"{}")))}return()=>P(e,T({ref:b},{...l,...V,items:void 0,on_submit:void 0},{onSubmit:$,onReset:O}),{default:()=>{var d,f;return[(d=l.items)==null?void 0:d.map(F=>P(_,T(F,{key:h(F)}),null)),(f=R.default)==null?void 0:f.call(R)]}})}}),formRenderProps:E,FormItemRender:B,formItemRenderProps:z}}export{je as a,Ie as c,Se as s,y as u};
